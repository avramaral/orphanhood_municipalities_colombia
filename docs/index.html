<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="André V. Ribeiro Amaral">
<meta name="dcterms.date" content="2024-11-06">

<title>Orphanhood estimates in Colombia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#fertility-and-mortality-rates" id="toc-fertility-and-mortality-rates" class="nav-link" data-scroll-target="#fertility-and-mortality-rates">Fertility and Mortality rates</a>
  <ul class="collapse">
  <li><a href="#bias-correction" id="toc-bias-correction" class="nav-link" data-scroll-target="#bias-correction">Bias Correction</a>
  <ul class="collapse">
  <li><a href="#mortality" id="toc-mortality" class="nav-link" data-scroll-target="#mortality">Mortality</a></li>
  <li><a href="#fertility" id="toc-fertility" class="nav-link" data-scroll-target="#fertility">Fertility</a></li>
  </ul></li>
  <li><a href="#corrected-rates" id="toc-corrected-rates" class="nav-link" data-scroll-target="#corrected-rates">Corrected rates</a></li>
  </ul></li>
  <li><a href="#orphanhood-estimates" id="toc-orphanhood-estimates" class="nav-link" data-scroll-target="#orphanhood-estimates">Orphanhood Estimates</a>
  <ul class="collapse">
  <li><a href="#uncorrected-results" id="toc-uncorrected-results" class="nav-link" data-scroll-target="#uncorrected-results">Uncorrected results</a></li>
  <li><a href="#corrected-results" id="toc-corrected-results" class="nav-link" data-scroll-target="#corrected-results">Corrected results</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Orphanhood estimates in Colombia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>André V. Ribeiro Amaral </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>The 32 departments and one capital district (Bogotá) can be grouped together into the 6 regions of Colombia (right panel), namely, (1) Caribe, (2) Eje cafetero y Antioquia, (3) Pacífica, (4) Central, (5) Llanos, and (6) Amazonía.</p>
<p>Colombia can still be divided into 1121 municipalities (this classification varies along the years, and we are using the definition from 2021).</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><img src="images/map1.png" height="300"></td>
<td><img src="images/map2.png" height="300"></td>
</tr>
</tbody>
</table>
</section>
<section id="fertility-and-mortality-rates" class="level1">
<h1>Fertility and Mortality rates</h1>
<p>Mortality and Fertility counts are expected to be underreported in the next most deprived municipalities. In particular, we will use the Multidimensional Poverty Index (MPI) as a way to measure the deprivation levels across the country.</p>
<p><img src="images/MPI.jpeg" height="300"></p>
<p>For instance, let us start by analyzing the standardized mortality and fertility rates in all locations (in 2018).</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><img src="images/std_mortality_comparison_map_raw.jpeg" height="300"></td>
<td><img src="images/std_fertility_comparison_map_raw.jpeg" height="300"></td>
</tr>
</tbody>
</table>
<p>Complementary, we can take a look at such rates as a function of the MPI. From these plots, we can see that the most deprived municipalities have the smallest standardized fertility and mortality rates–which is the opposite of what we would expect. Thus, we may want to account for underreporting.</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><img src="images/std_mortality_comparison_raw.jpeg" height="300"></td>
<td><img src="images/std_fertility_comparison_raw.jpeg" height="300"></td>
</tr>
</tbody>
</table>
<section id="bias-correction" class="level2">
<h2 class="anchored" data-anchor-id="bias-correction">Bias Correction</h2>
<p>Here, we provide details on the approach we took to correct the bias for both mortality and fertility rates.</p>
<section id="mortality" class="level3">
<h3 class="anchored" data-anchor-id="mortality">Mortality</h3>
<p>Let <span class="math inline">\(D_{y,a, g}^{\ell}\)</span> denote the number of deaths in year <span class="math inline">\(y\)</span>, for individuals of gender <span class="math inline">\(g\)</span> who belong to the age group <span class="math inline">\(a\)</span>, at location (e.g., municipality) <span class="math inline">\(\ell\)</span>. In the same setting, let <span class="math inline">\(P_{y,a, g}^{\ell}\)</span> denote the population size.</p>
<p>Aiming at modeling the death curves in each municipality following a similar pattern (by a shifting factor) to the national deaths, let us define <span class="math display">\[
\begin{align}
     D_{y,a, g}^{\text{Nat}} &amp;\sim \text{Binomial}\left(P_{y,a, g}^{\text{Nat}}, \mu_{y,a, g}^{D, \text{Nat}}\right) \\
     \text{logit}\left(\mu_{y,a, g}^{D, \text{Nat}}\right) &amp;= \beta_{0, y} + \beta_{1, y} \cdot 1\{g = \text{Male}\} + d_y^{\text{Female}}(a) \cdot 1\{g = \text{Female}\} + d_y^{\text{Male}}(a) \cdot 1\{g = \text{Male}\}, \nonumber
\end{align}
\]</span> where <span class="math inline">\(d_y^{g}(a)\)</span> is a random effect that varies over the age groups <span class="math inline">\(a\)</span>, and is defined for each gender <span class="math inline">\(g\)</span> and year <span class="math inline">\(y\)</span>. In particular, we will set it to a <span class="math inline">\(\text{GP}(0, \Sigma_{\theta_g})\)</span> with exponentiated quadratic kernel, such that <span class="math inline">\(\theta_d = (\ell_g, \sigma_g)^{\top}\)</span>.</p>
<p>Now, for each location <span class="math inline">\(\ell\)</span> at municipality level, let <span id="eq-death-rate"><span class="math display">\[
\log\left(\mu_{y,a, g}^{D, \ell}\right) = \log\left(\gamma_{y}^{\ell}\right) + \log\left(\mu_{y,a, g}^{D, \text{Nat}}\right),
\tag{1}\]</span></span> where <span class="math inline">\(\gamma_{y}^{\ell}\)</span> is a shifting factor (common for all age groups <span class="math inline">\(a\)</span> and genders <span class="math inline">\(g\)</span>).</p>
<p>Thus, in order to estimate <span class="math inline">\(\gamma_{g}^{\ell}\)</span>, define standardized death rate <span class="math inline">\(\nu_{y}^{\ell}\)</span> at municipality <span class="math inline">\(\ell\)</span> and in year <span class="math inline">\(y\)</span> as follows <span id="eq-std_death_rate"><span class="math display">\[
\nu_{y}^{\ell} = \sum_{a, g} \frac{P^{\text{Nat}}_{a, g}}{P^{\text{Nat}}} \cdot \hat{\mu}_{y,a, g}^{D, \ell},
\tag{2}\]</span></span> where <span class="math inline">\(\hat{\mu}_{y,a, g}^{D, \ell}\)</span> is the empirical death rate, and the reference population is determined based on the census of, e.g., 2018. In particular, we will compute <span class="math inline">\(\nu_{y}^{\ell}\)</span> for all department capitals, and smooth them out as in <span id="eq-std_linear"><span class="math display">\[
\nu_{y}^{\ell} = \alpha_{0, y} + x_{\ell} \cdot \alpha_{1, y} + \varepsilon_{y}^{\ell}, \text{ s.t. } \varepsilon_{y}^{\ell} \overset{\text{i.i.d.}}{\sim} \text{N}(0, \sigma_{\varepsilon}),
\tag{3}\]</span></span> where <span class="math inline">\(x_{\ell}\)</span> is the MPI at location <span class="math inline">\(\ell\)</span>. Then, the standardized death rate in all locations <span class="math inline">\(\ell\)</span> can be computed based on the estimates from <a href="#eq-std_linear">Equation&nbsp;3</a>.</p>
<p>Lastly, let <span class="math display">\[
\gamma_y^{\ell} = \min\left(\frac{\nu_y^{\ell}}{\nu_y^{\text{Nat}}}, \frac{\nu_{y}^{\text{Emp}}}{\nu_y^{\text{Nat}}}\right),
\]</span> where <span class="math inline">\(\nu_{y}^{\text{Emp}}\)</span> is the empirical (i.e., biased or uncorrected) standardized death rate and <span class="math inline">\(\nu_y^{\text{Nat}} = \left(P^{\text{Nat}}\right)^{-1} \cdot \sum_{a, g} P^{\text{Nat}}_{a, g} \cdot \mu_{y,a, g}^{D, \text{Nat}}\)</span>.</p>
<p>This allows us to estimate <span class="math inline">\(\mu_{y,a, g}^{\ell}\)</span>, such that the expected number of deaths in each municipality <span class="math inline">\(\ell\)</span> is given by <span class="math inline">\(P_{y, a, g}^{\ell} \times \mu_{y, a, g}^{D, \ell}\)</span>.</p>
</section>
<section id="fertility" class="level3">
<h3 class="anchored" data-anchor-id="fertility">Fertility</h3>
<p>Similarly to before, we can model the births as follows. Let <span class="math inline">\(B^{\ell}_{y, a, g}\)</span> denote the number of births in year <span class="math inline">\(y\)</span>, for individuals of gender <span class="math inline">\(g\)</span> who belong to age group <span class="math inline">\(a\)</span>, at location <span class="math inline">\(\ell\)</span>. Then, <span class="math display">\[\begin{align} \label{eq:national-birth}
     B_{y,a, g}^{\text{Nat}} &amp;\sim \text{Negative Binomial}\left(\mu_{y,a, g}^{B, \text{Nat}}, \phi_g\right) \\
     \text{log}\left(\mu_{y,a, g}^{B, \text{Nat}}\right) &amp;= \beta_{0, y}^g + d_y^g(a) \nonumber
\end{align}\]</span> where <span class="math inline">\(\mathbb{E}(B_{y,a, g}^{\text{Nat}}) = \mu_{y,a, g}^{\text{Nat}}\)</span> and <span class="math inline">\(\text{Var}(B_{y,a, g}^{\text{Nat}}) = \mu_{y,a, g}^{B, \text{Nat}} + \left[\left(\mu_{y,a, g}^{B, \text{Nat}}\right)^2 /\phi_g\right]\)</span>, such that <span class="math inline">\(\phi_g \geq 0\)</span> is an overdispersion parameter. Also, <span class="math inline">\(d_y^{g}(a)\)</span> is a random effect that varies over the age groups <span class="math inline">\(a\)</span>, and is defined for each gender <span class="math inline">\(g\)</span> and year <span class="math inline">\(y\)</span>. In particular, we will set it to a <span class="math inline">\(\text{GP}(0, \Sigma_{\theta_g})\)</span> with exponentiated quadratic kernel, such that <span class="math inline">\(\theta_g = (\ell_g, \sigma_g)^{\top}\)</span>.</p>
<p>Once again, the fertility rates <span class="math inline">\(\mu_{y,a, g}^{B, \ell}\)</span> in all locations will be computed as in <a href="#eq-death-rate">Equation&nbsp;1</a>, such that shifting factor <span class="math inline">\(\gamma_{y}^{\ell}\)</span> is determined based on the standardized fertility rate, defined similarly to <a href="#eq-std_death_rate">Equation&nbsp;2</a> and <a href="#eq-std_linear">Equation&nbsp;3</a>. Lastly, the expected number of births in each municipality <span class="math inline">\(\ell\)</span> will be given by <span class="math inline">\(P_{y, a, g}^{\ell} \times \mu_{y, a, g}^{B, \ell}\)</span>.</p>
</section>
</section>
<section id="corrected-rates" class="level2">
<h2 class="anchored" data-anchor-id="corrected-rates">Corrected rates</h2>
<p>To be completed.</p>
</section>
</section>
<section id="orphanhood-estimates" class="level1">
<h1>Orphanhood Estimates</h1>
<section id="uncorrected-results" class="level2">
<h2 class="anchored" data-anchor-id="uncorrected-results">Uncorrected results</h2>
<ul>
<li>Orphanhood incidence in Colombia in 2021: 69,956.</li>
<li>Orphanhood incidence (per children) in Colombia in 2021: 0.5%.</li>
<li>Orphanhood prevalence in Colombia in 2021: 423,670.</li>
<li>Orphanhood prevalence (per children) in Colombia in 2021: 3.00%.</li>
</ul>
</section>
<section id="corrected-results" class="level2">
<h2 class="anchored" data-anchor-id="corrected-results">Corrected results</h2>
<ul>
<li>Orphanhood incidence in Colombia in 2021: 100,134.</li>
<li>Orphanhood incidence (per children) in Colombia in 2021: 0.71%.</li>
<li>Orphanhood prevalence in Colombia in 2021: 623,218.</li>
<li>Orphanhood prevalence (per children) in Colombia in 2021: 4.42%.</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>